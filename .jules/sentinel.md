## 2024-05-23 - [Command Injection in Worker Source Fetching]
**Vulnerability:** The `fetch_source` function in `worker/src/executor.rs` constructed shell commands by directly interpolating the `source_url` into a single-quoted string (e.g., `git clone '{source_url}'`). This allowed an attacker to inject arbitrary shell commands by including a single quote in the URL (e.g., `http://example.com'; rm -rf /; echo '`).
**Learning:** When constructing shell commands using string formatting in Rust (or any language), simply wrapping variables in quotes is insufficient if the variable itself can contain the quote character. This is a classic "SQL injection for shell" pattern.
**Prevention:** I implemented manual escaping by replacing all single quotes (`'`) with the safe shell sequence `'\''`. For future implementations, prefer using `std::process::Command` with arguments passed as an array (which handles escaping automatically) rather than executing a full shell command string via `sh -c` or `ssh "cmd"`. In this case, since we are executing via `ssh`, we are forced to construct a remote command string, making strict manual escaping mandatory.
